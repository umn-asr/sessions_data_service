services:
  web:
    logging:
      options:
        max-size: 50m
    build:
      context: .
      target: development
    environment:
      NLS_LANG: "AMERICAN_AMERICA.WE8ISO8859P1"
    ports:
      - 127.0.0.1:3000:3000
      - 127.0.0.1:3001:3001
    volumes:
      - '.:/home/app'
    entrypoint: ["script/_entrypoint.sh"]
    command: 'bash -c ./script/_server'
    command: >
      bash -c 'until ./script/_database_check.sh;
      do
        :
      done && echo "Database check complete" && ./script/_web_container_setup && ./script/_update && ./script/_server'
